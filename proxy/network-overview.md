# 网络配置总览

多场景网络配置方案，支持国内/新加坡双环境。

---

## 网络架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        网络配置总览                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌──────────────┐     ┌──────────────┐     ┌──────────────┐    │
│  │   代理服务    │     │   VPN 服务   │     │  远程连接     │    │
│  ├──────────────┤     ├──────────────┤     ├──────────────┤    │
│  │ WgetCloud    │     │ OpenVPN      │     │ Tailscale    │    │
│  │ (主力梯子)    │     │ (亦庄显卡)   │     │ (家里主机)   │    │
│  ├──────────────┤     ├──────────────┤     └──────────────┘    │
│  │ 呆鹅云       │     │ 奇安信零信任  │                         │
│  │ (备用梯子)    │     │ (上庄显卡)   │                         │
│  └──────────────┘     ├──────────────┤                         │
│                       │ 飞连         │                         │
│                       │ (字节显卡)   │                         │
│                       └──────────────┘                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 服务详情

### 代理服务

| 服务 | 用途 | 订阅地址 | 到期时间 |
|------|------|----------|----------|
| **WgetCloud** | 主力梯子，日常翻墙 | wgetcloud.ltd | 2026-01-22 |
| **呆鹅云** | 备用梯子 | sillygoose.cloud | 2026-03-24 |

### VPN 服务

| 服务 | 用途 | 服务器 | 内网 IP 段 |
|------|------|--------|-----------|
| **OpenVPN** | 亦庄显卡集群 | ssl-vpn.x-humanoid-cloud.com | 10.51.0.0/16 |
| **奇安信零信任** | 上庄显卡集群 | - | 待配置 |
| **飞连** | 字节显卡集群 | - | 待配置 |

### 远程连接

| 服务 | 用途 | IP |
|------|------|-----|
| **Tailscale** | 家里 Windows 主机 | 100.96.157.50 |

---

## 场景方案

### 🇨🇳 国内方案

在中国大陆时的网络配置：

```
┌─────────────────────────────────────────────────────────┐
│                    国内网络方案                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  访问目标              使用服务           备注           │
│  ─────────────────────────────────────────────────────  │
│  Google/GitHub        WgetCloud         翻墙必需        │
│  亦庄显卡             OpenVPN           10.51.x.x       │
│  上庄显卡             奇安信零信任       待配置          │
│  字节显卡             飞连              待配置          │
│  家里主机             Tailscale         100.96.157.50   │
│  国内网站             直连              不走代理        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Clash 配置要点**：
- 启用 TUN 模式
- WgetCloud 作为主订阅
- 添加所有 VPN 直连规则

### 🇸🇬 新加坡方案

在新加坡时的网络配置：

```
┌─────────────────────────────────────────────────────────┐
│                   新加坡网络方案                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  访问目标              使用服务           备注           │
│  ─────────────────────────────────────────────────────  │
│  Google/GitHub        直连              无需翻墙        │
│  国内网站             WgetCloud 回国    可选            │
│  亦庄显卡             OpenVPN           需要连          │
│  上庄显卡             奇安信零信任       需要连          │
│  字节显卡             飞连              需要连          │
│  家里主机             Tailscale         100.96.157.50   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**配置要点**：
- 可以关闭 Clash（不需要翻墙）
- 或切换 Clash 规则为"回国模式"（访问国内视频等）
- VPN 服务正常使用，不受影响
- Tailscale 全球可用

---

## Clash Verge 直连规则

确保所有 VPN 流量绑过 Clash：

```yaml
prepend:
  # Tailscale 直连
  - IP-CIDR,100.64.0.0/10,DIRECT,no-resolve
  - DOMAIN-SUFFIX,tailscale.com,DIRECT
  - DOMAIN-SUFFIX,tailscale.io,DIRECT

  # OpenVPN (亦庄显卡) 直连
  - IP-CIDR,10.51.0.0/16,DIRECT,no-resolve
  - IP-CIDR,180.76.235.174/32,DIRECT,no-resolve
  - DOMAIN-SUFFIX,x-humanoid-cloud.com,DIRECT

  # 奇安信零信任 (上庄显卡) 直连 - 待补充
  # - IP-CIDR,x.x.x.x/x,DIRECT,no-resolve
  # - DOMAIN-SUFFIX,qianxin.com,DIRECT

  # 飞连 (字节显卡) 直连 - 待补充
  # - IP-CIDR,x.x.x.x/x,DIRECT,no-resolve
  # - DOMAIN-SUFFIX,feilian.xxx,DIRECT
```

---

## 系统代理绕过配置

`verge.yaml` 中的 `system_proxy_bypass`：

```yaml
system_proxy_bypass: localhost,127.*,10.*,100.*,172.16.*,172.17.*,172.18.*,172.19.*,172.20.*,172.21.*,172.22.*,172.23.*,172.24.*,172.25.*,172.26.*,172.27.*,172.28.*,172.29.*,172.30.*,172.31.*,192.168.*,<local>,*.tailscale.com,*.tailscale.io,*.bytedance.net,*.byted.org,*.x-humanoid-cloud.com,180.76.235.174
```

---

## 快速切换指南

### 从国内到新加坡

1. **关闭或切换 Clash**
   - 方案 A：直接关闭 Clash Verge（新加坡无需翻墙）
   - 方案 B：切换到"回国节点"（需要访问国内限定内容时）

2. **VPN 服务不变**
   - OpenVPN、奇安信、飞连继续正常使用
   - Tailscale 全球可用

### 从新加坡回国内

1. **开启 Clash Verge**
2. **选择合适的节点**（新加坡/香港/美国等）
3. **确认 VPN 直连规则生效**

---

## 待配置项

### 奇安信零信任

连接上庄显卡时，需要补充：
- [ ] 服务器地址
- [ ] 内网 IP 段
- [ ] 添加 Clash 直连规则

### 飞连

连接字节显卡时，需要补充：
- [ ] 服务器地址
- [ ] 内网 IP 段
- [ ] 添加 Clash 直连规则

**获取方式**：连接 VPN 后运行 `ifconfig` 或 `netstat -rn` 查看分配的 IP 和路由。

---

## 相关文档

- [Clash 与 Tailscale 兼容配置](clash-tailscale.md)
- [Clash 与 OpenVPN 兼容配置](clash-openvpn.md)
- [Tailscale + 远程桌面教程](../remote-desktop/tailscale-rdp.md)
